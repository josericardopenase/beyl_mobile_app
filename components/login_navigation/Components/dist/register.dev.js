"use strict";var _interopRequireDefault=require("@babel/runtime/helpers/interopRequireDefault");var _interopRequireWildcard=require("@babel/runtime/helpers/interopRequireWildcard");Object.defineProperty(exports,"__esModule",{value:true});exports["default"]=Register;var _regenerator=_interopRequireDefault(require("@babel/runtime/regenerator"));var _slicedToArray2=_interopRequireDefault(require("@babel/runtime/helpers/slicedToArray"));var _formik=require("formik");var _react=_interopRequireWildcard(require("react"));var _reactNative=require("react-native");var _reactNativeGestureHandler=require("react-native-gesture-handler");var _form=_interopRequireDefault(require("../../general_components/form"));var _FormButton=_interopRequireDefault(require("../../general_components/forms/FormButton"));var _FormEmail=_interopRequireDefault(require("../../general_components/forms/high_level_inputs/FormEmail"));var _FormPassword=_interopRequireDefault(require("../../general_components/forms/high_level_inputs/FormPassword"));var _formCompleteInput=_interopRequireDefault(require("../../general_components/forms/input_types/formCompleteInput"));var _generalContainer=_interopRequireDefault(require("../../general_components/generalContainer"));var _bold=_interopRequireDefault(require("../../general_components/titles/bold"));var _title=_interopRequireDefault(require("../../general_components/titles/title1"));var _title2=_interopRequireDefault(require("../../general_components/titles/title3"));var _formDateTimePicker=_interopRequireDefault(require("../../general_components/forms/input_types/formDateTimePicker2"));var Yup=_interopRequireWildcard(require("yup"));var _apiAuth=_interopRequireDefault(require("../../../api/apiAuth"));var _titleError=_interopRequireDefault(require("../../general_components/titles/titleError"));var _context2=_interopRequireDefault(require("../../../auth/context"));var _storage=_interopRequireDefault(require("../../../auth/storage"));var _FormPicker=_interopRequireDefault(require("../../general_components/forms/FormPicker"));var _jsxFileName="/home/pepe/Escritorio/beylapp/components/login_navigation/Components/register.js";var validationSchema=Yup.object().shape({email:Yup.string().required().email().label("Email"),password:Yup.string().required().label("Password").matches(/^(?=.*[a-z])(?=.*[A-Z])(?=.*[0-9])(?=.{8,})/,"Tiene que tener una mayúscula, al menos un  \n número y mínimo 8 carácteres"),name:Yup.string().required().label("Nombre"),surname:Yup.string().required().label("Apellidos"),height:Yup.number("Tiene que ser un número").required().min(100).max(300).label("Altura"),weight:Yup.number("Tiene que ser un número").required().min(10).max(250).label("Peso"),sex:Yup.string().required().oneOf(['Hombre','Mujer','Otro']).label("Sexo"),key:Yup.string().required().label("Clave de entrenador"),alergias:Yup.string().optional().label("Alergias"),born_date:Yup.string().required().label("Fecha de nacimiento"),sport:Yup.string().required().label("Actividad física")});function Register(props){var authContext=(0,_react.useContext)(_context2["default"]);var _useState=(0,_react.useState)(false),_useState2=(0,_slicedToArray2["default"])(_useState,2),loginFailed=_useState2[0],setLoginFailed=_useState2[1];var _useState3=(0,_react.useState)(""),_useState4=(0,_slicedToArray2["default"])(_useState3,2),error=_useState4[0],setError=_useState4[1];var handleSubmit=function handleSubmit(values){var result;return _regenerator["default"].async(function handleSubmit$(_context){while(1){switch(_context.prev=_context.next){case 0:console.log(values);_context.next=3;return _regenerator["default"].awrap(_apiAuth["default"].register(values));case 3:result=_context.sent;if(result.ok){_context.next=10;break;}if(result.data.non_field_errors!=undefined)setError(result.data.non_field_errors[0]);else{console.log(result);setError("Este email ya esta en uso");}setLoginFailed(true);return _context.abrupt("return");case 10:setLoginFailed(false);authContext.setUser(result.data.token);_storage["default"].setUser(result.data.token);case 13:case"end":return _context.stop();}}});};return _react["default"].createElement(_generalContainer["default"],{__source:{fileName:_jsxFileName,lineNumber:73,columnNumber:9}},_react["default"].createElement(_reactNativeGestureHandler.ScrollView,{showsVerticalScrollIndicator:false,__source:{fileName:_jsxFileName,lineNumber:74,columnNumber:13}},_react["default"].createElement(_title["default"],{__source:{fileName:_jsxFileName,lineNumber:75,columnNumber:13}},_react["default"].createElement(_bold["default"],{__source:{fileName:_jsxFileName,lineNumber:75,columnNumber:21}},"Registrate")," en beyl"),_react["default"].createElement(_reactNative.View,{style:{marginTop:20},__source:{fileName:_jsxFileName,lineNumber:76,columnNumber:13}},_react["default"].createElement(_formik.Formik,{initialValues:{email:'',password:'',name:'',surname:'',height:'',weight:'',sex:'',key:props.route.params.key,alergias:'',born_date:'',sport:''},validationSchema:validationSchema,onSubmit:function onSubmit(values){return handleSubmit(values);},__source:{fileName:_jsxFileName,lineNumber:77,columnNumber:21}},function(_ref){var handleSubmit=_ref.handleSubmit;return _react["default"].createElement(_form["default"],{__source:{fileName:_jsxFileName,lineNumber:84,columnNumber:25}},_react["default"].createElement(_title2["default"],{style:{marginBottom:20},__source:{fileName:_jsxFileName,lineNumber:85,columnNumber:29}},"Informaci\xF3n b\xE1sica"),_react["default"].createElement(_FormEmail["default"],{__source:{fileName:_jsxFileName,lineNumber:86,columnNumber:29}}),_react["default"].createElement(_FormPassword["default"],{__source:{fileName:_jsxFileName,lineNumber:87,columnNumber:29}}),_react["default"].createElement(_title2["default"],{style:{marginTop:30},__source:{fileName:_jsxFileName,lineNumber:89,columnNumber:29}},"Datos personales"),_react["default"].createElement(_formCompleteInput["default"],{name:"name",placeholder:"Nombre",icon:"account",__source:{fileName:_jsxFileName,lineNumber:90,columnNumber:29}}),_react["default"].createElement(_formCompleteInput["default"],{name:"surname",placeholder:"Apellidos",icon:"account",__source:{fileName:_jsxFileName,lineNumber:91,columnNumber:29}}),_react["default"].createElement(_formDateTimePicker["default"],{name:"born_date",placeholder:"Fecha de nacimiento",mode:"date",first:true,__source:{fileName:_jsxFileName,lineNumber:92,columnNumber:29}}),_react["default"].createElement(_title2["default"],{style:{marginTop:30},__source:{fileName:_jsxFileName,lineNumber:94,columnNumber:29}},"Datos f\xEDsicos"),_react["default"].createElement(_formCompleteInput["default"],{name:"height",placeholder:"Altura en cm",icon:"altimeter",__source:{fileName:_jsxFileName,lineNumber:95,columnNumber:29}}),_react["default"].createElement(_formCompleteInput["default"],{name:"weight",placeholder:"Peso en kg",icon:"weight-gram",__source:{fileName:_jsxFileName,lineNumber:96,columnNumber:29}}),_react["default"].createElement(_FormPicker["default"],{name:"sport",placeholder:"Actividad física",icon:"gender-male-female",options:[{label:"Poco o ningún ejercicio",value:1.2},{label:"Ejercicio ligero (1-3 días a la semana)",value:1.375},{label:"Ejercicio moderado (3-5 días a la semana)",value:"Otro"},{label:"Ejercicio fuerte (6-7 días a la semana)",value:1.725},{label:"Ejercicio muy fuerte (dos veces al día)",value:1.9}],__source:{fileName:_jsxFileName,lineNumber:97,columnNumber:29}}),_react["default"].createElement(_FormPicker["default"],{name:"sex",placeholder:"sexo",icon:"gender-male-female",options:[{label:"Hombre",value:"Hombre"},{label:"Mujer",value:"Mujer"},{label:"Otro",value:"Otro"}],__source:{fileName:_jsxFileName,lineNumber:98,columnNumber:29}}),_react["default"].createElement(_formCompleteInput["default"],{name:"alergias",placeholder:"Alergias",icon:"food",__source:{fileName:_jsxFileName,lineNumber:99,columnNumber:29}}),_react["default"].createElement(_titleError["default"],{error:error,visible:loginFailed,__source:{fileName:_jsxFileName,lineNumber:100,columnNumber:29}}),_react["default"].createElement(_FormButton["default"],{placeholder:"Vamos alla!",onPress:handleSubmit,__source:{fileName:_jsxFileName,lineNumber:102,columnNumber:29}}));}))));}